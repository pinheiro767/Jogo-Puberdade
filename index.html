<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Jornada da Puberdade: Conhecendo as transformaÃ§Ãµes do meu corpo</title>
    
    <link rel="stylesheet" href="css/styles.css">

</head>
<body>
    <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e3c72, #2a5298); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10001; transition: opacity 0.5s ease;">
        <h1 style="font-size: 2.5em; margin-bottom: 30px; text-align: center; max-width: 90%;">Puberdade: Conhecendo as transformaÃ§Ãµes do meu corpo</h1>
        
        <video id="intro-video" style="display: none; margin-bottom: 20px;" controls width="640" height="360">
            <source src="video/Anime_Transformation_A_Teenager_s_Crisis.mp4" type="video/mp4">
            Seu navegador nÃ£o suporta a tag de vÃ­deo.
        </video>

        <div id="intro-content" style="text-align: center; max-width: 600px; padding: 0 20px;">
            <p style="font-size: 1.2em; margin-bottom: 30px; opacity: 0.9;">
                Bem-vindo Ã  jornada de descoberta sobre as mudanÃ§as que acontecem durante a puberdade! 
                Este Ã© um momento especial de crescimento e transformaÃ§Ã£o.
            </p>
            <p style="margin-bottom: 30px; opacity: 0.8;">
                VocÃª aprenderÃ¡ sobre as mudanÃ§as fÃ­sicas e emocionais de forma divertiva e educativa atravÃ©s de cenÃ¡rios interativos.
            </p>
        </div>

        <button id="start-button" style="padding: 15px 30px; font-size: 1.2em; background: #4CAF50; border: none; color: white; font-weight: bold; border-radius: 10px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: all 0.3s ease;">
            â–¶ï¸ Ver IntroduÃ§Ã£o
        </button>
    </div>

    <button id="mute-button" onclick="toggleMute()">ğŸ”‡</button>

    <div class="game-container">
        <div class="sidebar">
            <div class="stats">
                <h3>ğŸ† Status do Jogador</h3>
                <div class="stat-item">
                    <span>ğŸ’ª SaÃºde:</span>
                    <span id="health">70</span>
                </div>
                <div class="stat-item">
                    <span>ğŸ§  Conhecimento:</span>
                    <span id="knowledge">50</span>
                </div>
                <div class="stat-item">
                    <span>ğŸ˜Š ConfianÃ§a:</span>
                    <span id="confidence">60</span>
                </div>
                <div class="stat-item">
                    <span>ğŸš¿ Higiene:</span>
                    <span id="hygiene">65</span>
                </div>
                <div class="stat-item">
                    <span>ğŸ… Medalhas:</span>
                    <span id="medals">0</span>
                </div>
            </div>
            
            <div class="stats">
                <h3>ğŸ¯ Objetivos de Aprendizado</h3>
                <div style="font-size: 0.9em; line-height: 1.5;">
                    <p>â€¢ Compreender as mudanÃ§as fÃ­sicas</p>
                    <p>â€¢ Entender as mudanÃ§as emocionais</p>
                    <p>â€¢ Aprender sobre higiene pessoal</p>
                    <p>â€¢ Desenvolver autoconfianÃ§a</p>
                    <p>â€¢ Aceitar as transformaÃ§Ãµes naturais</p>
                </div>
            </div>
        </div>

        <main class="main-content" id="main-content">
            <div class="welcome-section" id="welcome-section">
                <h1>ğŸŒŸ Jornada da Puberdade</h1>
                <p>Descubra as transformaÃ§Ãµes incrÃ­veis que acontecem durante a puberdade atravÃ©s de cenÃ¡rios interativos e educativos!</p>
                <button class="start-game-btn" onclick="startGame()">ğŸš€ ComeÃ§ar Aventura</button>
            </div>

            <div class="game-content" id="game-content">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                
                <div id="character-container" style="text-align: center; margin: 30px 0;">
                    <div style="position: relative; display: inline-block;">
                        <img id="boy-character" src="images/1000006911.png" alt="Garoto pronto para aprender" onclick="triggerRandomScenario()">
                        
                        <div id="thought-bubble">
                            Clique no garoto para aprender!
                        </div>
                    </div>
                </div>
                
                <div id="scenario-container"></div> 
            </div>
        </main>
    </div>

    <div class="medal-notification" id="medal-notification">
        <h2>ğŸ… ParabÃ©ns!</h2>
        <p id="medal-text">VocÃª ganhou uma medalha!</p>
        <button onclick="closeMedalNotification()" style="background: #4a90e2; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 15px;">Continuar</button>
    </div>

    <div class="message" id="message"></div>
    
    <div id="success-animation-container">
        <div id="sparkle-effect" style="width: 100px; height: 100px; display: none; font-size: 4em;">âœ¨</div>
    </div>

    <div id="question-modal">
        <div id="modal-content">
            <h3 id="modal-scenario-text"></h3>
            <div id="modal-options-container"></div>
        </div>
    </div>

    <audio id="background-music" loop muted volume="0.3">
        <source src="audio/bgm.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-click" muted>
        <source src="audio/dice_roll.ogg" type="audio/ogg">
    </audio>
    <audio id="sfx-success" muted>
        <source src="audio/coin.wav" type="audio/wav">
    </audio>
    <audio id="sfx-fail" muted>
        <source src="audio/error.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-win" muted>
        <source src="audio/win.wav" type="audio/wav">
    </audio>


    <script>
        // --- ESTADO INICIAL DO JOGO ---
        let gameState = {
            health: 70, knowledge: 50, confidence: 60, hygiene: 65, medals: 0
        };
        let currentScenario = 0;
        
        // --- VARIÃVEIS DE CONTROLO DE MÃDIA ---
        let soundEnabled = true; // Controla EFEITOS VISUAIS
        let isMuted = true; // Controla ÃUDIO
        
        // --- REFERÃŠNCIAS AOS ELEMENTOS HTML (CACHE) ---
        const bgMusic = document.getElementById('background-music');
        const sfxClick = document.getElementById('sfx-click');
        const sfxSuccess = document.getElementById('sfx-success');
        const sfxFail = document.getElementById('sfx-fail');
        const sfxWin = document.getElementById('sfx-win');
        const muteButton = document.getElementById('mute-button');
        
        const introVideo = document.getElementById('intro-video');
        const startButton = document.getElementById('start-button');
        const splashScreen = document.getElementById('splash-screen');
        const introContent = document.getElementById('intro-content'); // ReferÃªncia ao texto intro
        const sparkleEffect = document.getElementById('sparkle-effect'); 
        const boyCharacter = document.getElementById('boy-character');
        const thoughtBubble = document.getElementById('thought-bubble');
        const welcomeSection = document.getElementById('welcome-section');
        const gameContent = document.getElementById('game-content');
        const scenarioContainer = document.getElementById('scenario-container');
        const modal = document.getElementById('question-modal');
        const modalScenarioText = document.getElementById('modal-scenario-text');
        const modalOptionsContainer = document.getElementById('modal-options-container');
        const messageDiv = document.getElementById('message');
        const medalNotificationDiv = document.getElementById('medal-notification');
        const medalTextSpan = document.getElementById('medal-text');
        const healthSpan = document.getElementById('health');
        const knowledgeSpan = document.getElementById('knowledge');
        const confidenceSpan = document.getElementById('confidence');
        const hygieneSpan = document.getElementById('hygiene');
        const medalsSpan = document.getElementById('medals');
        const progressFillDiv = document.getElementById('progress-fill');
        
        // --- MAPA DE IMAGENS DO PERSONAGEM ---
        const imageMap = {
            NEUTRAL: 'images/1000006911.png',
            HAPPY: 'images/1000006910.png',
            SAD: 'images/1000006909.png'
        };

        // --- CENÃRIOS/PERGUNTAS ---
        const scenarios = [
            // Cola aqui TODOS os teus 46 cenÃ¡rios. 
            // Exemplo:
            {
                text: "Qual o erro mais comum ao usar um preservativo masculino e como corrigi-lo?",
                options: [
                    { 
                        text: "NÃ£o verificar o prazo de validade antes de usar.", 
                        effects: { knowledge: +5, confidence: +5 }, 
                        feedback: "Verificar o prazo Ã© importante, mas o erro mais comum Ã© nÃ£o retirar o ar da ponta do preservativo antes de desenrolÃ¡-lo no pÃªnis.",
                        correct: false
                    },
                    { 
                        text: "NÃ£o retirar o ar da ponta do preservativo antes de desenrolÃ¡-lo.", 
                        effects: { knowledge: +20, confidence: +15 }, 
                        feedback: "Correto! O erro mais comum Ã© nÃ£o retirar o ar da ponta do preservativo...",
                        correct: true
                    }
                ]
            },
            // ... (restantes 45 cenÃ¡rios) ...
            {
                text: "Verdade ou Mito: O sexo anal Ã© uma prÃ¡tica de baixo risco para a transmissÃ£o de IST...",
                options: [
                    { 
                        text: "MITO. O sexo anal Ã© de alto risco...", 
                        effects: { knowledge: +25, health: +20 }, 
                        feedback: "Correto! Ã‰ MITO...",
                        correct: true
                    },
                    { 
                        text: "VERDADE. O sexo anal tem menor risco...", 
                        effects: { knowledge: -25, health: -25 }, 
                        feedback: "Ã‰ MITO! O sexo anal tem MAIOR risco...",
                        correct: false
                    }
                ]
            }
        ];

        // --- FUNÃ‡Ã•ES DE ÃUDIO ---
        function playSound(soundName) {
            if (isMuted) return;
            const sounds = { 
                'click': sfxClick, 'success': sfxSuccess, 'fail': sfxFail, 'win': sfxWin
            };
            const sound = sounds[soundName];
            if (sound) {
                sound.currentTime = 0; // Reinicia o Ã¡udio
                // sound.load(); // NÃ£o Ã© geralmente necessÃ¡rio com play()
                sound.play().catch(e => console.error('Audio play failed:', e));
            }
        }

        function toggleMute() {
            isMuted = !isMuted;
            soundEnabled = !soundEnabled; // Sincroniza efeitos visuais com Ã¡udio
            
            const allAudios = [bgMusic, sfxClick, sfxSuccess, sfxFail, sfxWin];
            allAudios.forEach(a => a.muted = isMuted);
            
            muteButton.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š';
            
            if (!isMuted) {
                playMusic(); // Tenta tocar a mÃºsica se desmutar
                showNotification('ğŸ”Š Ãudio e efeitos visuais ativados!', 'success');
            } else {
                bgMusic.pause(); // Pausa a mÃºsica se mutar
                showNotification('ğŸ”‡ Ãudio e efeitos visuais desativados', 'info');
            }
        }

        function playMusic() {
            if (isMuted || !bgMusic.paused) return; // NÃ£o toca se jÃ¡ estiver tocando
            bgMusic.currentTime = 0;
            bgMusic.play().catch(e => console.error("Autoplay music failed:", e));
        }
        
        // --- FUNÃ‡Ã•ES DE EFEITOS VISUAIS (CSS) ---
        function playVisualEffect(type) {
            if (!soundEnabled) return; 
            const gameContainer = document.querySelector('.game-container'); // Precisa da referÃªncia aqui
            
            switch(type) {
                case 'success':
                    createSuccessEffect(gameContainer); // Passa a referÃªncia
                    break;
                case 'fail':
                    createErrorEffect(gameContainer); // Passa a referÃªncia
                    break;
                case 'win':
                    createWinEffect(gameContainer); // Passa a referÃªncia
                    break;
                default: // 'click'
                    createClickEffect();
            }
        }

        function createSuccessEffect(gameContainer) { // Recebe gameContainer
            const overlay = document.createElement('div');
            overlay.className = 'success-overlay';
            document.body.appendChild(overlay);
            
            gameContainer.classList.add('success-glow');
            
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createSparkle();
                    if (i % 2 === 0) createDiamond();
                }, i * 100);
            }
            
            setTimeout(() => {
                overlay.remove();
                gameContainer.classList.remove('success-glow');
            }, 2000);
        }

        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.textContent = Math.random() > 0.5 ? 'âœ¨' : 'â­';
            sparkle.style.left = `${Math.random() * 100}vw`; // Usa vw/vh para cobrir a tela
            sparkle.style.top = `${Math.random() * 100}vh`;
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 2000);
        }

        function createDiamond() {
            const diamond = document.createElement('div');
            diamond.className = 'diamond';
            diamond.textContent = Math.random() > 0.5 ? 'ğŸ’' : 'ğŸ’ ';
            diamond.style.left = `${Math.random() * 100}vw`;
            diamond.style.top = `${Math.random() * 100}vh`;
            document.body.appendChild(diamond);
            setTimeout(() => diamond.remove(), 2500);
        }

        function createErrorEffect(gameContainer) { // Recebe gameContainer
            gameContainer.classList.add('shake-screen');
            
            const crackOverlay = document.createElement('div');
            crackOverlay.className = 'crack-overlay';
            document.body.appendChild(crackOverlay);
            
            gameContainer.classList.add('error-flash');
            
            for (let i = 0; i < 8; i++) {
                setTimeout(createCrackLine, i * 100);
            }
            
            setTimeout(() => {
                gameContainer.classList.remove('shake-screen', 'error-flash');
                crackOverlay.remove();
            }, 1500);
        }

        function createCrackLine() {
            const crack = document.createElement('div');
            crack.className = 'crack-line';
            
            const isVertical = Math.random() > 0.5;
            if (isVertical) {
                crack.style.width = '2px';
                crack.style.height = `${Math.random() * 200 + 50}px`;
            } else {
                crack.style.width = `${Math.random() * 200 + 50}px`;
                crack.style.height = '2px';
            }
            crack.style.left = `${Math.random() * 100}vw`;
            crack.style.top = `${Math.random() * 100}vh`;
            
            document.body.appendChild(crack);
            setTimeout(() => crack.remove(), 1000);
        }

        function createWinEffect(gameContainer) { // Recebe gameContainer
            createSuccessEffect(gameContainer); // Usa o efeito base
            setTimeout(() => {
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        createSparkle();
                        createDiamond();
                    }, i * 50);
                }
            }, 500); // Adiciona mais brilho depois
        }

        function createClickEffect() {
            // Este nÃ£o precisa do gameContainer, Ã© um pop-up simples
            const effect = document.createElement('div');
            effect.style.cssText = `
                position: fixed; top: 50%; left: 50%;
                transform: translate(-50%, -50%);
                font-size: 3em; z-index: 9999;
                pointer-events: none;
                animation: effectPop 1s ease forwards;
                color: #4a90e2;
            `;
            effect.textContent = 'â­';
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 1000);
        }
        
        // --- FUNÃ‡Ã•ES DE FEEDBACK VISUAL ---
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 80px; right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#4a90e2'};
                color: white; padding: 15px 20px; border-radius: 10px;
                z-index: 9999; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => notification.remove(), 300); // Remove apÃ³s animaÃ§Ã£o
            }, 3000); // DuraÃ§Ã£o da notificaÃ§Ã£o
        }

        function showMessage(text) {
            messageDiv.textContent = text;
            messageDiv.style.display = 'block';
            // Usa classes CSS para animaÃ§Ã£o (se existirem no styles.css)
            // messageDiv.classList.add('show'); 
            
            setTimeout(() => {
                 messageDiv.style.display = 'none';
                 // messageDiv.classList.remove('show');
            }, 4000); // DuraÃ§Ã£o da mensagem
        }

        // --- FUNÃ‡Ã•ES DE CONTROLO DO JOGO ---
        function startGame() {
            welcomeSection.style.display = 'none'; // Esconde a secÃ§Ã£o de boas-vindas
            gameContent.style.display = 'block'; // Mostra o conteÃºdo principal do jogo
            updateThoughtBubble("Clique em mim para uma nova dÃºvida!");
        }

        function triggerRandomScenario() {
            if (currentScenario >= scenarios.length) {
                showMessage("ParabÃ©ns! VocÃª respondeu a todas as dÃºvidas!");
                showFinalResults(); // Mostra os resultados se jÃ¡ acabou
                return;
            }
            
            playSound('click'); 
            playVisualEffect('click'); 
            showScenarioModal(); // Abre o modal com a pergunta
        }

        function showScenarioModal() {
            const scenario = scenarios[currentScenario];
            
            modalScenarioText.textContent = scenario.text;
            modalOptionsContainer.innerHTML = ''; // Limpa opÃ§Ãµes anteriores
            
            // Cria os botÃµes de opÃ§Ã£o dinamicamente
            scenario.options.forEach((option, index) => {
                const button = document.createElement('button');
                // Adiciona estilos inline (poderiam estar no CSS)
                button.style.cssText = `
                    display: block; width: 100%; margin: 10px 0; padding: 15px; 
                    background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 10px; 
                    cursor: pointer; text-align: left; font-size: 1.1em; 
                    transition: all 0.3s ease;
                `;
                button.textContent = option.text;
                button.onclick = () => selectModalOption(index);
                // Efeito hover simples
                button.onmouseover = () => { button.style.background='#e3f2fd'; button.style.borderColor='#4a90e2'; };
                button.onmouseout = () => { button.style.background='#f8f9fa'; button.style.borderColor='#e9ecef'; };
                
                modalOptionsContainer.appendChild(button);
            });
            
            modal.style.display = 'flex'; // Mostra o modal
        }

        function selectModalOption(selectedIndex) {
            const scenario = scenarios[currentScenario];
            const option = scenario.options[selectedIndex];
            
            // Aplica os efeitos da opÃ§Ã£o escolhida ao estado do jogo
            Object.keys(option.effects).forEach(stat => {
                // Limita os stats entre 0 e 100 (exceto conhecimento, talvez?)
                gameState[stat] = Math.max(0, Math.min(100, gameState[stat] + option.effects[stat]));
            });

            updateStats(); // Atualiza a sidebar
            
            // Feedback imediato e efeitos
            if (option.correct) {
                changeCharacterExpression('HAPPY');
                showMessage("ğŸ‰ " + option.feedback); // Mostra o feedback positivo
                playSound('success'); 
                playVisualEffect('success'); 
                showSparkleAnimation(); // Mostra o brilho âœ¨
                
                // Verifica se ganhou medalhas
                checkMedals(); 
            } else {
                changeCharacterExpression('SAD');
                showMessage("ğŸ¤” " + option.feedback); // Mostra o feedback construtivo
                playSound('fail'); 
                playVisualEffect('fail'); 
            }
            
            currentScenario++; // AvanÃ§a para o prÃ³ximo cenÃ¡rio
            updateProgress(); // Atualiza a barra de progresso
            updateThoughtBubble(getRandomThought()); // Muda o pensamento do personagem
            
            modal.style.display = 'none'; // Esconde o modal
            
            // Verifica se o jogo terminou
            if (currentScenario >= scenarios.length) {
                setTimeout(showFinalResults, 2000); // Mostra resultados apÃ³s um delay
            }
        }

        // --- FUNÃ‡Ã•ES DE ATUALIZAÃ‡ÃƒO DA INTERFACE ---
        function setCharacterImage(imageName) {
             boyCharacter.src = imageName; 
        }

        function changeCharacterExpression(expression) {
            let imageName;
            let gradient; // Fundo do cÃ­rculo da imagem
            
            switch(expression) {
                case 'HAPPY':
                    imageName = imageMap.HAPPY;
                    gradient = 'linear-gradient(135deg, #4CAF50, #45a049)';
                    break;
                case 'SAD':
                    imageName = imageMap.SAD;
                    gradient = 'linear-gradient(135deg, #f44336, #d32f2f)';
                    break;
                default: // NEUTRAL
                    imageName = imageMap.NEUTRAL;
                    gradient = 'linear-gradient(135deg, #4a90e2, #357abd)';
            }
            setCharacterImage(imageName);
            boyCharacter.style.background = gradient; // Atualiza o fundo
            
            // Temporizador para voltar ao neutro
            setTimeout(() => {
                setCharacterImage(imageMap.NEUTRAL);
                boyCharacter.style.background = 'linear-gradient(135deg, #4a90e2, #357abd)';
            }, 3000); // Volta ao normal apÃ³s 3 segundos
        }
        
        // FunÃ§Ã£o para mostrar a animaÃ§Ã£o âœ¨
        function showSparkleAnimation() {
            sparkleEffect.style.display = 'block';
            sparkleEffect.style.animation = 'sparkleAnimation 1s ease'; // Reinicia a animaÃ§Ã£o
            
            // Esconde apÃ³s a animaÃ§Ã£o terminar
            setTimeout(() => {
                sparkleEffect.style.display = 'none';
                sparkleEffect.style.animation = 'none'; // Prepara para a prÃ³xima vez
            }, 1000);
        }

        function updateThoughtBubble(text) {
            thoughtBubble.textContent = text;
        }

        function getRandomThought() {
            const thoughts = [
                "Que interessante!", "Aprendi algo novo!", "A puberdade tem destas coisas...",
                "PrÃ³xima dÃºvida!", "Vamos continuar!", "Conhecimento Ã© poder!"
            ];
            return thoughts[Math.floor(Math.random() * thoughts.length)];
        }

        function updateStats() {
            healthSpan.textContent = gameState.health;
            knowledgeSpan.textContent = gameState.knowledge;
            confidenceSpan.textContent = gameState.confidence;
            hygieneSpan.textContent = gameState.hygiene;
            medalsSpan.textContent = gameState.medals;
        }

        function updateProgress() {
            const progress = (currentScenario / scenarios.length) * 100;
            progressFillDiv.style.width = `${progress}%`;
        }

        // --- FUNÃ‡Ã•ES DE MEDALHAS E FIM DE JOGO ---
         function checkMedals() {
            // LÃ³gica simples: uma medalha a cada X pontos ou por marco
            if (gameState.knowledge >= 80 && gameState.medals === 0) {
                 setTimeout(() => awardMedal("SÃ¡bio Iniciante! ğŸ¥‰"), 500); // Pequeno delay
            } else if (gameState.confidence >= 80 && gameState.medals === 1) {
                 setTimeout(() => awardMedal("ConfianÃ§a em Alta! ğŸ¥ˆ"), 500);
            } else if (gameState.hygiene >= 85 && gameState.medals === 2) {
                 setTimeout(() => awardMedal("Mestre da Limpeza! ğŸ¥‡"), 500);
            }
            // Adicionar mais condiÃ§Ãµes para mais medalhas se quiser
        }

        function awardMedal(medalText) {
            if (medalNotificationDiv.style.display === 'block') return; // Evita mÃºltiplas notificaÃ§Ãµes

            gameState.medals++;
            updateStats(); // Atualiza o contador na sidebar
            medalTextSpan.textContent = medalText; // Define o texto da notificaÃ§Ã£o
            medalNotificationDiv.style.display = 'block'; // Mostra a notificaÃ§Ã£o
            playSound('win'); 
            playVisualEffect('win'); 
        }

        function closeMedalNotification() {
            medalNotificationDiv.style.display = 'none';
        }

        function showFinalResults() {
            let performance = '';
            const totalScore = gameState.health + gameState.knowledge + gameState.confidence + gameState.hygiene;
            
            // Define a mensagem de performance baseada na pontuaÃ§Ã£o total
            if (totalScore >= 320) performance = 'Excelente! VocÃª domina o assunto! ğŸŒŸ';
            else if (totalScore >= 280) performance = 'Muito bom! Quase um expert! ğŸ‘';
            else if (totalScore >= 240) performance = 'Bom trabalho! Continue aprendendo! ğŸ’ª';
            else performance = 'VocÃª comeÃ§ou a jornada! Continue explorando! ğŸ“š';

            // Cria o HTML para mostrar os resultados finais
            scenarioContainer.innerHTML = `
                <div class="question-card">
                    <h2>ğŸŠ ParabÃ©ns! Jornada ConcluÃ­da!</h2>
                    <div style="text-align: center; padding: 20px;">
                        <h3>${performance}</h3>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; text-align: left;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;"><strong>ğŸ’ª SaÃºde:</strong> ${gameState.health}</div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;"><strong>ğŸ§  Conhecimento:</strong> ${gameState.knowledge}</div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;"><strong>ğŸ˜Š ConfianÃ§a:</strong> ${gameState.confidence}</div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;"><strong>ğŸš¿ Higiene:</strong> ${gameState.hygiene}</div>
                        </div>
                        <p style="font-size: 1.2em; margin: 20px 0;"><strong>ğŸ… Medalhas: ${gameState.medals}</strong></p>
                        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left;">
                            <h4>ğŸ¯ RevisÃ£o RÃ¡pida:</h4>
                            <p>â€¢ A puberdade Ã© normal e saudÃ¡vel.</p>
                            <p>â€¢ MudanÃ§as fÃ­sicas e emocionais acontecem.</p>
                            <p>â€¢ Higiene Ã© chave!</p>
                            <p>â€¢ Aceite as transformaÃ§Ãµes.</p>
                            <p>â€¢ Informe-se sempre!</p>
                        </div>
                        <button onclick="restartGame()" class="start-game-btn" style="background: linear-gradient(45deg, #4CAF50, #45a049);">ğŸ”„ Jogar Novamente</button>
                    </div>
                </div>
            `;
            
            updateProgress(); // Garante que a barra chegue a 100%
            playSound('win'); 
            playVisualEffect('win'); 
        }

        function restartGame() {
            currentScenario = 0;
            gameState = { // Reinicia o estado do jogo
                health: 70, knowledge: 50, confidence: 60, hygiene: 65, medals: 0
            };
            updateStats(); // Atualiza a sidebar
            progressFillDiv.style.width = '0%'; // Reinicia a barra de progresso
            scenarioContainer.innerHTML = ''; // Limpa a Ã¡rea de cenÃ¡rios
            updateThoughtBubble("Vamos de novo! Clique em mim.");
            // NÃ£o precisa mexer no welcomeSection ou gameContent, eles jÃ¡ estÃ£o no estado certo
        }

        // --- INICIALIZAÃ‡ÃƒO DO JOGO ---

        // Evento: Clicar no botÃ£o "Ver IntroduÃ§Ã£o"
        startButton.addEventListener('click', () => {
            introContent.style.display = 'none'; // Esconde texto intro
            startButton.style.display = 'none'; // Esconde botÃ£o intro
            introVideo.style.display = 'block'; // Mostra vÃ­deo
            
            introVideo.muted = false; // Tira o mute do vÃ­deo
            introVideo.play().catch(e => {
                console.error("Video play failed:", e);
                // Se o vÃ­deo falhar, esconde o splash e inicia o jogo diretamente
                splashScreen.style.opacity = '0';
                setTimeout(() => { splashScreen.style.display = 'none'; }, 500);
                startGame(); // Chama o inÃ­cio do jogo sem o vÃ­deo
            });

            // Ativa os Ã¡udios do jogo (mas ainda nÃ£o toca a mÃºsica de fundo)
            isMuted = false;
            soundEnabled = true; 
            [bgMusic, sfxClick, sfxSuccess, sfxFail, sfxWin].forEach(a => a.muted = false);
            muteButton.textContent = 'ğŸ”Š'; // Atualiza o botÃ£o de mute
        });

        // Evento: VÃ­deo terminou de tocar
        introVideo.addEventListener('ended', () => {
            // Esconde o ecrÃ£ splash com fade out
            splashScreen.style.opacity = '0';
            setTimeout(() => { splashScreen.style.display = 'none'; }, 500); // Remove apÃ³s transiÃ§Ã£o
            
            playMusic(); // Agora sim, toca a mÃºsica de fundo
            startGame(); // Inicia a interface principal do jogo
        });
        
        // Garante que os controlos do vÃ­deo apareÃ§am quando carregado
        introVideo.addEventListener('loadeddata', () => {
            introVideo.controls = true; 
        });
        
        // --- CÃ“DIGO EXECUTADO QUANDO A PÃGINA CARREGA ---
        muteButton.textContent = isMuted ? 'ğŸ”‡' : 'ğŸ”Š'; // Define estado inicial do botÃ£o mute
        updateStats(); // Mostra os stats iniciais na sidebar
        // Nota: startGame() sÃ³ Ã© chamado apÃ³s o vÃ­deo ou se o vÃ­deo falhar.
        
    </script>
</body>
</html>
