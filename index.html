<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jornada da Puberdade: Conhecendo as transformações do meu corpo</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    
    <div id="splash-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e3c72, #2a5298); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10001; transition: opacity 0.5s ease;">
        <h1 style="font-size: 2.5em; margin-bottom: 30px; text-align: center;">Puberdade: Conhecendo as transformações do meu corpo</h1>
        
        <video id="intro-video" style="display: none; margin-bottom: 20px;" controls width="640" height="360">
            <source src="video/Anime_Transformation_A_Teenager_s_Crisis.mp4" type="video/mp4">
            Seu navegador não suporta a tag de vídeo.
        </video>

        <p id="splash-message" style="margin-bottom: 30px; opacity: 0.9;">Clique para ver a introdução e iniciar o Game.</p>

        <button id="start-button" style="padding: 15px 30px; font-size: 1.2em; background: #4CAF50; border: none; color: white; font-weight: bold; border-radius: 10px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
            ▶️ Ver Introdução
        </button>
    </div>

    <div class="game-container">
        <div class="sidebar">
            <div class="stats">
                <h3>🏆 Conquistas do Jogador</h3>
                <div class="stat-item">
                    <span>🧠 Conhecimento (Pts):</span>
                    <span id="knowledge">50</span>
                </div>
                <div class="stat-item">
                    <span>🏅 Medalhas Acumuladas:</span>
                    <span id="medals">0</span>
                </div>
            </div>
            
            <div class="stats">
                <h3>📚 Ganhar Conhecimento</h3>
                <div class="job-option" onclick="doJob('readPubertyBook', 50, 6000, '🧠')">
                    <div class="job-icon">📖</div>
                    <div class="job-info">
                        <div class="job-name">Pesquisar/Ler sobre Puberdade</div>
                        <div class="job-reward">+50 Conhecimento, +15 Autoestima (6s)</div>
                    </div>
                </div>
                </div>

            <div class="controls">
                <button class="btn" onclick="resetRoom()">🔄 Recomeçar Jornada</button>
            </div>
        </div>

        <div class="main-content" id="main-content">
            <div class="floating-particles">
                <div class="particle">✨</div>
                <div class="particle">🌟</div>
                <div class="particle">💫</div>
                <div class="particle">⭐</div>
                <div class="particle">🔮</div>
                <div class="particle">💎</div>
                <div class="particle">🌈</div>
                <div class="particle">🎯</div>
            </div>
            
            <div id="character-container">
                <img id="boy-character" src="images/1000006911.png" alt="Garoto pronto para aprender" onclick="triggerRandomScenario()"> 
                <div id="thought-bubble">Clique no garoto para aprender!</div>
            </div>
        </div>
    </div>
    
    <div class="message" id="message"></div>
    <div id="success-animation-container">
        <img id="sparkle-gif" src="images/sparkle.gif" alt="Animação de Sucesso" style="width: 100px; height: 100px; display: none; position: absolute; z-index: 100;">
    </div>

    <div id="question-modal">
        <div id="modal-content">
            <h3 id="modal-scenario-text"></h3>
            <div id="modal-options-container"></div>
        </div>
    </div>

    <button id="mute-button" onclick="toggleMute()">🔇</button>

    <audio id="background-music" loop muted volume="0.3">
        <source src="audio/bgm.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-click" muted>
        <source src="audio/dice_roll.ogg" type="audio/ogg">
    </audio>
    <audio id="sfx-success" muted>
        <source src="audio/coin.wav" type="audio/wav">
    </audio>
    <audio id="sfx-fail" muted>
        <source src="audio/error.mp3" type="audio/mpeg">
    </audio>
    <audio id="sfx-win" muted>
        <source src="audio/win.wav" type="audio/wav">
    </audio>
    <audio id="sfx-job-start" muted>
        <source src="audio/move.mp3" type="audio/mpeg">
    </audio>

    <script>
        let gameState = {
            health: 70,
            knowledge: 50,
            confidence: 60,
            hygiene: 65,
            medals: 0,
            activeJobs: new Map()
        };
        
        const bgMusic = document.getElementById('background-music');
        const sfxClick = document.getElementById('sfx-click');
        const sfxSuccess = document.getElementById('sfx-success');
        const sfxFail = document.getElementById('sfx-fail');
        const sfxWin = document.getElementById('sfx-win');
        const sfxJobStart = document.getElementById('sfx-job-start');
        const muteButton = document.getElementById('mute-button');
        let isMuted = true;

        bgMusic.volume = 0.3;

        const boyCharacter = document.getElementById('boy-character');
        const thoughtBubble = document.getElementById('thought-bubble');
        const mainContent = document.getElementById('main-content');
        const sparkleGif = document.getElementById('sparkle-gif');
        
        // NOVAS REFERÊNCIAS
        const introVideo = document.getElementById('intro-video');
        const startButton = document.getElementById('start-button');
        const splashScreen = document.getElementById('splash-screen');
        const splashMessage = document.getElementById('splash-message');


        const imageMap = {
            NEUTRAL: '1000006911.png',
            HAPPY: '1000006910.png',
            SAD: '1000006909.png'
        };

        // =================================================================
        // === BANCO DE CENÁRIOS ATUALIZADO (INÍCIO) ===
        // Este é o bloco de código que foi substituído para
        // incluir todas as novas perguntas.
        // =================================================================
        const scenarios = [
            // --- Perguntas que já tinhas, agora atualizadas com o texto completo ---
            {
                text: "Meus pelos estão crescendo, é normal?",
                options: [
                    { text: "Sim! O crescimento de pelos corporais é um sinal comum da puberdade causado por hormônios.", effects: { confidence: +20, knowledge: +25 }, sfx: 'success' },
                    { text: "Fico preocupado e acho que é falta de vitaminas ou algo errado.", effects: { confidence: -15, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "A masturbação é uma prática normal na adolescência?",
                options: [
                    { text: "Sim, é normal e saudável! É uma forma de autoconhecimento e alívio de tensão.", effects: { confidence: +20, knowledge: +25 }, sfx: 'success' },
                    { text: "Sinto vergonha e acho que é errado ou doentio.", effects: { confidence: -15, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "Minha voz está falhando e às vezes eu fico rouco, o que é isso?",
                options: [
                    { text: "É normal! A laringe está a crescer (muda vocal) e depois estabiliza. É temporário.", effects: { confidence: +20, knowledge: +20 }, sfx: 'success' },
                    { text: "Fico envergonhado e evito falar. Deve ser uma infeção.", effects: { confidence: -15, knowledge: -5 }, sfx: 'fail' }
                ]
            },
            {
                text: "Devo me comparar com meus amigos que já estão mais desenvolvidos?",
                options: [
                    { text: "Não! Cada pessoa tem seu próprio ritmo. A puberdade pode começar em idades diferentes.", effects: { confidence: +25, knowledge: +20 }, sfx: 'success' },
                    { text: "Sim, se eu for o último é porque algo está errado comigo.", effects: { confidence: -20, health: -5 }, sfx: 'fail' }
                ]
            },
            {
                text: "Ter “sonhos molhados” ou acordar com a roupa úmida é normal?",
                options: [
                    { text: "Sim! São as poluções noturnas. É uma liberação natural de fluidos sexuais durante o sono.", effects: { confidence: +25, knowledge: +20 }, sfx: 'success' },
                    { text: "Não, isso é muito estranho. Significa que fiz xixi na cama.", effects: { confidence: -15, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "O orgasmo dura sempre o mesmo tempo para todas as pessoas?",
                options: [
                    { text: "Não! O orgasmo é muito variável. A duração e a intensidade são diferentes para cada pessoa.", effects: { confidence: +10, knowledge: +20 }, sfx: 'success' },
                    { text: "Sim, dura sempre 10 segundos. Se for diferente, algo está errado.", effects: { confidence: -5, knowledge: -5 }, sfx: 'fail' }
E             ]
            },
            {
                text: "Ter uma ereção “do nada” (sem pensar nisso) é normal?",
                options: [
                    { text: "Sim! As ereções espontâneas são comuns devido a hormônios ou reflexos nervosos. É um sinal de corpo saudável.", effects: { confidence: +25, knowledge: +25 }, sfx: 'success' },
                    { text: "Não, é constrangedor e significa que estou sempre a ter pensamentos inadequados.", effects: { confidence: -20, knowledge: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "O que eu sinto não é importante. Devo guardar tudo para mim?",
                options: [
                    { text: "Não! Compartilhar sentimentos com alguém de confiança é fundamental para a sua saúde mental.", effects: { confidence: +30, health: +15 }, sfx: 'success' },
                    { text: "Sim, é melhor ser forte e não incomodar os outros com meus problemas.", effects: { confidence: -20, health: -15 }, sfx: 'fail' }
                ]
            },

            // --- Novas Perguntas da Tua Lista (que não estavam no código) ---
            {
                text: "Meu corpo está estranho — o que é isso?",
                options: [
                    { text: "As mudanças corporais fazem parte da puberdade. Elas variam entre pessoas e levam tempo.", effects: { confidence: +20, knowledge: +20 }, sfx: 'success' },
                    { text: "Deve ser algo que comi. O corpo não deve mudar tanto assim.", effects: { confidence: -10, knowledge: -5 }, sfx: 'fail' }
                ]
            },
            {
                text: "Por que estou sempre cansado ultimamente?",
                options: [
                    { text: "Durante a puberdade, o ciclo do sono muda e os hormônios estão ativos. É normal precisar de mais sono.", effects: { confidence: +15, health: +10 }, sfx: 'success' },
                    { text: "Isso é só preguiça. Se dormires menos, o corpo acostuma.", effects: { confidence: -10, health: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "É verdade que a gente começa a transpirar mais intensamente?",
                options: [
                    { text: "Sim! As glândulas de suor ficam mais ativas. Um bom banho e desodorante ajudam.", effects: { hygiene: +20, knowledge: +15 }, sfx: 'success' },
                    { text: "Não, a transpiração é igual a vida toda. Se estou a transpirar muito é porque estou doente.", effects: { hygiene: -10, confidence: -10 }, sfx: 'fail' }
A             ]
            },
            {
  T           text: "Eu choro por coisas bobas ou sinto raiva sem motivo. É só frescura?",
                options: [
                    { text: "Não é frescura! O cérebro está em desenvolvimento e os hormônios causam flutuações no humor.", effects: { confidence: +25, health: +10 }, sfx: 'success' },
                    { text: "Sim, é frescura. Pessoas fortes não choram por coisas bobas, tens de te controlar.", effects: { confidence: -20, health: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "É obrigatório ter um pênis grande para ser “homem”?",
                options: [
                    { text: "Não! O tamanho varia muito e não define masculinidade. O importante é ter um desenvolvimento saudável.", effects: { confidence: +30, knowledge: +20 }, sfx: 'success' },
                    { text: "Sim, o tamanho do pênis é a característica mais importante da masculinidade.", effects: { confidence: -25, knowledge: -10 }, sfx: 'fail' }
                ]
            },

            // --- Perguntas que já tinhas no teu código (cenários de higiene/crescimento) ---
            {
                text: "Meus desodorantes não funcionam mais e estou suando muito. O que devo usar?",
                options: [
                    { text: "Trocar para um antitranspirante ou sabonete antibacteriano, pois o suor mudou na puberdade.", effects: { hygiene: +20, confidence: +15 }, sfx: 'success' },
                    { text: "Lavar mais vezes com sabonete comum, ou usar produtos infantis.", effects: { hygiene: -10, confidence: -10 }, sfx: 'fail' }
                ]
            },
            {
                text: "Minha voz quebra e não consigo cantar ou falar com clareza. Devo me preocupar?",
                options: [
                    { text: "Não, é a 'muda vocal', temporária e normal. O processo é de 6 meses a 2 anos.", effects: { knowledge: +25, confidence: +15 }, sfx: 'success' },
                N     { text: "Sim, devo parar de falar e cantar para não danificar minhas cordas vocais.", effects: { knowledge: -10, confidence: -5 }, sfx: 'fail' }
                ]
            },
            {
                text: "Estou crescendo muito rápido, pareço desajeitado e esbarro em tudo. Isso é normal?",
A               options: [
                    { text: "Sim! É o 'estirão' de crescimento; o corpo está se adaptando ao novo tamanho. A coordenação logo volta.", effects: { knowledge: +20, confidence: +20 }, sfx: 'success' },
                    { text: "Não! É um sinal de que estou crescendo errado e preciso de sapatos ortopédicos.", effects: { knowledge: -5, confidence: -10 }, sfx: 'fail' }
                ]
            }
        ];
        // =================================================================
        // === BANCO DE CENÁRIOS ATUALIZADO (FIM) ===
        // =================================================================

        // VARIÁVEIS DE CONTROLE DE PERGUNTAS (Para evitar repetição)
        let availableScenarios = [];
        
        function shuffleArray(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function populateAvailableScenarios() {
            availableScenarios = shuffleArray(scenarios.slice());
        }
        
        function animateSuccess() {
            // Posiciona e mostra o GIF sobre o personagem
            sparkleGif.style.top = `${boyCharacter.offsetTop - 50}px`;
            sparkleGif.style.left = `${boyCharacter.offsetLeft + 50}px`;
            sparkleGif.style.display = 'block';

            // Esconde o GIF após 1.5 segundos
            setTimeout(() => {
                sparkleGif.style.display = 'none';
            }, 1500);
        }
        
        // Removida a função watchVideo, pois o vídeo agora é a introdução

        function playSound(soundName) {
            if (isMuted) return;
            const sounds = { 
                'click': sfxClick, 
                'success': sfxSuccess, 
                'fail': sfxFail, 
                'win': sfxWin,
                'job-start': sfxJobStart 
            };
            const sound = sounds[soundName];
            if (sound) {
                sound.currentTime = 0;
                sound.load(); 
                sound.play().catch(e => console.log('Audio play failed:', e));
            }
        }

        function toggleMute() {
            isMuted = !isMuted;
            const allAudios = [bgMusic, sfxClick, sfxSuccess, sfxFail, sfxWin, sfxJobStart];
            allAudios.forEach(a => a.muted = isMuted);
            muteButton.textContent = isMuted ? '🔇' : '🔊';
SI         if (!isMuted) playMusic();
            else bgMusic.pause();
        }
        
        function playMusic() {
            if (isMuted) return;
            bgMusic.currentTime = 0;
            bgMusic.play().catch(e => console.log("Autoplay music failed:", e));
        }

        function setCharacterImage(imageName) {
            boyCharacter.src = `images/${imageName}`;
E       }

        function updateScenario() {
            if (gameState.medals >= 6) {
                mainContent.className = 'main-content scenario-3';
                showMessage("✨ Seu conhecimento atingiu o máximo!", false);
            } else if (gameState.medals >= 3) {
                mainContent.className = 'main-content scenario-2';
A         }
        }

        function updateStats() {
            document.getElementById('knowledge').textContent = Math.round(gameState.knowledge) + ' pts';
            document.getElementById('medals').textContent = gameState.medals;
            updateScenario();
        }

        function giveRewardItem() {
            gameState.medals += 1;
            applyEffects({ knowledge: 30, confidence: 15 });
            showMessage('🎉 PRÊMIO! Você ganhou uma Medalha!', false);
aS         playSound('win');
            updateStats();
        }

        function triggerRandomScenario() {
            if (document.getElementById('question-modal').style.display === 'flex') {
                showMessage("Responda primeiro!", true);
                playSound('fail');
                return;
            }
            
            // Não precisa verificar o vídeo aqui, pois ele estará escondido após a introdução.

            if (availableScenarios.length === 0) {
                populateAvailableScenarios();
                showMessage("🎉 Você esgotou o banco de dúvidas! As perguntas foram resetadas.", false);
            }
            
            const scenario = availableScenarios.pop();
A           
            showQuestionModal(scenario);
            playSound('win');
            
            boyCharacter.classList.remove('boy-happy', 'boy-sad');
            setCharacterImage(imageMap.NEUTRAL); 
            boyCharacter.classList.add('boy-sad'); 
            thoughtBubble.textContent = "Uau, preciso responder isso!";
        }

        function showQuestionModal(scenario) {
            const modal = document.getElementById('question-modal');
            const text = document.getElementById('modal-scenario-text');
            const container = document.getElementById('modal-options-container');
            text.textContent = scenario.text;
            container.innerHTML = '';
            scenario.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'modal-option';
                button.textContent = option.text;
                button.onclick = () => selectOption(option);
Container             container.appendChild(button);
            });
            modal.style.display = 'flex';
        }

        function selectOption(option) {
            applyEffects(option.effects);
            document.getElementById('question-modal').style.display = 'none';
            playSound(option.sfx);
            
            const isCorrect = option.sfx === 'success';
            const feedbackText = `${isCorrect ? '✅ Resposta Correta! Ganhou Conhecimento.' : '❌ Resposta Incorreta. Perdeu Confiança.'}`;
            showMessage(feedbackText, !isCorrect);
            
            boyCharacter.classList.remove('boy-happy', 'boy-sad'); 
            
            if (isCorrect) {
                animateSuccess(); 
                setCharacterImage(imageMap.HAPPY);
                boyCharacter.classList.add('boy-happy');
                thoughtBubble.textContent = "Acertei! Me sinto um super-herói!";
aS             giveRewardItem();
            } else {
                setCharacterImage(imageMap.SAD);
                boyCharacter.classList.add('boy-sad');
                thoughtBubble.textContent = "Que pena, essa dúvida me deixou confuso.";
            }

            setTimeout(() => {
                boyCharacter.classList.remove('boy-happy', 'boy-sad');
CHAMADA             setCharacterImage(imageMap.NEUTRAL); 
                thoughtBubble.textContent = "Clique no garoto para aprender!";
            }, 3000);
            
            updateStats();
        }

        function applyEffects(effects) {
            Object.keys(effects).forEach(stat => {
                if (gameState.hasOwnProperty(stat)) {
                    if (stat !== 'knowledge') {
CONTEÚDO                 gameState[stat] = Math.max(0, Math.min(100, gameState[stat] + effects[stat]));
                    } else {
                        gameState[stat] = Math.max(0, gameState[stat] + effects[stat]);
EFEITOS               }
                }
    _       });
        }

        function doJob(jobType, reward, duration, emoji) {
            if (gameState.activeJobs.has(jobType)) {
                showMessage("Aguarde, a pesquisa está em andamento!", true);
Player             playSound('fail'); 
                return;
            }
            
            // Não precisa verificar o vídeo aqui.


Ambos           gameState.activeJobs.set(jobType, true);
            showMessage(`Iniciando ${emoji} Leitura...`);
            playSound('job-start');
            setTimeout(() => {
                applyEffects({ knowledge: reward, confidence: 15 });
                showMessage(`Atividade concluída! +${reward} Conhecimento 🧠`);
                gameState.activeJobs.delete(jobType);
  g           updateStats();
            }, duration);
        }

        function resetRoom() {
            window.location.reload();
        }

        function showMessage(text, isError = false) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = 'message' + (isError ? ' error' : '');
            message.classList.add('show');
            setTimeout(() => message.classList.remove('show'), 6000);
        }

        // --- LÓGICA DE INICIALIZAÇÃO CORRIGIDA PARA USAR O BOTÃO ---
        document.addEventListener('DOMContentLoaded', () => {
            
            // AÇÃO DO BOTÃO: Ativar o vídeo e o som com a interação do usuário
CSS         startButton.addEventListener('click', () => {
                // 1. Esconde o botão e a mensagem
                startButton.style.display = 'none';
                splashMessage.style.display = 'none';
g               
                // 2. Mostra e liga o vídeo 
                introVideo.style.display = 'block';
                introVideo.muted = false; 

                introVideo.play().catch(e => {
                BETWEEN   // Se o play falhar (raro após o clique), dá uma mensagem de erro
                    console.log("Erro ao iniciar a reprodução após o clique.", e);
                    splashMessage.textContent = "Erro ao iniciar. Tente novamente ou verifique as configurações do navegador.";
                    splashMessage.style.display = 'block';
                });

                // Inicializa o som de fundo e os SFX (o jogo só inicia após o 'ended')
                isMuted = false;
                [bgMusic, sfxClick, sfxSuccess, sfxFail, sfxWin, sfxJobStart].forEach(a => a.muted = false);
            });


            // EVENTO CHAVE: O JOGO SÓ INICIA QUANDO O VÍDEO TERMINA
    Z       introVideo.addEventListener('ended', () => {
                // Toca a música de fundo e inicia o jogo
                playMusic(); 
                
                // Remove a tela splash
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
Imagens                 initializeGame(); 
                }, 500);
            });
            
            // Oculta os controles de vídeo antes de iniciar
            introVideo.addEventListener('loadeddata', () => {
                introVideo.controls = true; 
  s         });
            
            muteButton.textContent = isMuted ? '🔇' : '🔊';
        });

        function initializeGame() {
            populateAvailableScenarios(); 
            updateStats();
        }
    </script>
</body>
</html>
